/*======================================================
//????????r_matmul
//??????????Á½??Êµ??????????
//??????????a(??????) b(?Ò¾???)  c(????????)
            m(??????????) p(??????????) n(?Ò¾???????)
//????Öµ?????Ð³É¹??ò·µ»?1,Ê§???ò·µ»?0
=========================================================*/
#include "stdio.h"
#include "stdlib.h"

int r_matmul(a, b, m, p, n, c)
double* a, *b, *c;
int m, p, n;
{
    int i, j, k;
    double tmp;

    if (!(m > 0 && p > 0 && n > 0)) {          /* ?????????????Ä½???*/
        printf("Dimension of a matrix is incorrect\n");
        return (0);
    }

    if (a == NULL || b == NULL || c == NULL) { /* ????????Ö¸???Ç·?Îª??*/
        printf("The matrix pointer is NULL\n");
        return (0);
    }

    for (i = 0; i < m; i++)           /* Ñ­??????????c?Ðµ?Ã¿??Ôª??*/
        for (j = 0; j < n; j++) {
            tmp = 0.0;                /* ??Öµ?È´?????Ê±??Á¿??*/

            for (k = 0; k < p; k++) {     /* Ñ­???Û¼?*/
                tmp += a[i * p + k] * b[k * n + j];
            }

            c[i * n + j] = tmp;               /* ???Ãµ??Ä½???????????c??*/
        }

    return (1);
}
