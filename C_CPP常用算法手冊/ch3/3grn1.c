
double grn1(u, g, r)
double u, g, *r;
{
    int i, m;
    double s, w, v, t;
    s = 65536.0;
    w = 2053.0;
    v = 13849.0;
    t = 0.0;

    for (i = 1; i <= 12; i++) {
        *r = (*r) * w + v;
        m = (int)(*r / s);
        *r = *r - m * s;
        t = t + (*r) / s;
    }

    t = u + g * (t - 6.0);
    return (t);
}

